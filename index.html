<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <style>
        .pseudo {
            background-color: black;
            color: white;
            font-weight: bold;
        }
    </style>
</head>
<body>

<h1>Le super Chat temps réel !</h1>

<div id="conversation">

</div>

<form action="">
    <input type="text" name="message" id="message" placeholder="Votre message ..."/>
    <input type="submit" value="Envoyer"/>
</form>

<div>

</div>

</body>

<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
<script>
    $(function () {

        var pseudo = '';

        /*
         * connection
         */
        var socket = io.connect('http://localhost:8080');

        /*
         * demande d'un pseudo
         */
        socket.on('demande_pseudo', function() {
            pseudo = prompt('Entrez votre pseudo : ');
            socket.emit('pseudo', pseudo);
        });

        /*
         * réception d'un message
         */
        socket.on('message', function(msg) {
            $('#conversation').append('<p>' + msg + '</p>');
        });

        /*
         * entrée d'un message
         */
        $('form').submit(function () {
            m = $('#message');
            socket.emit('message', '<span class="pseudo">' + pseudo + '</span> ' + m.val());
            m.val('');
            return false;
        });
    });
</script>

</html>
